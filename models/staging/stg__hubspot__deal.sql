select 
    deal.deal_id,
    deal_contact.contact_id,
    deal.property_hs_v_2_date_exited_174666285 as date_exited_opportunities_unengaged,
    deal.property_hs_v_2_date_entered_174666285 as date_entered_opportunities_unengaged,
    deal.property_hs_v_2_cumulative_time_in_174666285 as cumulative_time_in_opportunities_unengaged,
    deal.property_hs_v_2_latest_time_in_174666285 as latest_time_in_opportunities_unengaged,
    deal.property_hs_v_2_cumulative_time_in_220335375 as cumulative_time_in_leads_in_progress,
    deal.property_hs_v_2_date_entered_220335375 as date_entered_leads_in_progress,
    deal.property_hs_v_2_date_exited_220335375 as date_exited_leads_in_progress,
    deal.property_hs_v_2_latest_time_in_220335375 as latest_time_in_leads_in_progress,
    deal.property_hs_v_2_cumulative_time_in_174666286 as cumulative_time_in_match_in_progress,
    deal.property_hs_v_2_date_entered_174666286 as date_entered_match_in_progress,
    deal.property_hs_v_2_date_exited_174666286 as date_exited_match_in_progress,
    deal.property_hs_v_2_latest_time_in_174666286 as latest_time_in_match_in_progress,
    deal.property_hs_v_2_cumulative_time_in_174666287 as cumulative_time_in_match_shared,
    deal.property_hs_v_2_date_entered_174666287 as date_entered_match_shared,
    deal.property_hs_v_2_date_exited_174666287 as date_exited_match_shared,
    deal.property_hs_v_2_latest_time_in_174666287 as latest_time_in_match_shared,
    deal.property_hs_v_2_cumulative_time_in_219182604 as cumulative_time_in_match_pending,
    deal.property_hs_v_2_date_entered_219182604 as date_entered_match_pending,
    deal.property_hs_v_2_date_exited_219182604 as date_exited_match_pending,
    deal.property_hs_v_2_latest_time_in_219182604 as latest_time_in_match_pending,
    deal.property_hs_v_2_cumulative_time_in_174666288 as cumulative_time_in_appointment_booked_closed_won,
    deal.property_hs_v_2_date_entered_174666288 as date_entered_appointment_booked_closed_won,
    deal.property_hs_v_2_date_exited_174666288 as date_exited_appointment_booked_closed_won,
    deal.property_hs_v_2_latest_time_in_174666288 as latest_time_in_appointment_booked_closed_won,
    deal.property_hs_v_2_cumulative_time_in_174666291 as cumulative_time_in_closed_lost,
    deal.property_hs_v_2_date_entered_174666291 as date_entered_closed_lost,
    deal.property_hs_v_2_date_exited_174666291 as date_exited_closed_lost,
    deal.property_hs_v_2_latest_time_in_174666291 as latest_time_in_closed_lost
from {{ source('hubspot', 'deal') }} deal 
left join {{ source('hubspot', 'deal_contact') }} deal_contact 
    on deal.deal_id = deal_contact.deal_id